package did

import (
	"encoding/json"

	"github.com/golang/mock/gomock"
)

const (
	didShortForm1 = "did:ion:test:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA"
	didLongForm1  = "did:ion:test:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJpUkpfMGJQN0V6Q1NHRnBHYnYtaFlXZTdoZzItTkJhbDZxOU4tMUc3VWxJIiwieSI6IjZQZWV4VHF4V01WMy1Tc1pXT2tMbHkzN3V6Zm5iUUpFbUVMOEcyMnp5UVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlEU2NyamQ4eVNQM2NTRUJiTXd3YXpGb3RCTzFkM0l4QlZOQ1hBQjhpMkJ2dyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQnRGQ0x2SnVKc2xyNm16UWZxMUxnMGJiR29adWl3OE9CUmFRRVRNWEdfelEiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUNBTkFQR2hZSVdtWVRaOVlHTDMxdEJOWmlvbTgybzl6OUVkS3RlX3NaN3h3In19"
	didDoc1InJSON = `{"@context":"https://w3id.org/did-resolution/v1","didDocument":{"id":"did:ion:test:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJpUkpfMGJQN0V6Q1NHRnBHYnYtaFlXZTdoZzItTkJhbDZxOU4tMUc3VWxJIiwieSI6IjZQZWV4VHF4V01WMy1Tc1pXT2tMbHkzN3V6Zm5iUUpFbUVMOEcyMnp5UVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlEU2NyamQ4eVNQM2NTRUJiTXd3YXpGb3RCTzFkM0l4QlZOQ1hBQjhpMkJ2dyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQnRGQ0x2SnVKc2xyNm16UWZxMUxnMGJiR29adWl3OE9CUmFRRVRNWEdfelEiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUNBTkFQR2hZSVdtWVRaOVlHTDMxdEJOWmlvbTgybzl6OUVkS3RlX3NaN3h3In19","@context":["https://www.w3.org/ns/did/v1",{"@base":"did:ion:test:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJpUkpfMGJQN0V6Q1NHRnBHYnYtaFlXZTdoZzItTkJhbDZxOU4tMUc3VWxJIiwieSI6IjZQZWV4VHF4V01WMy1Tc1pXT2tMbHkzN3V6Zm5iUUpFbUVMOEcyMnp5UVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlEU2NyamQ4eVNQM2NTRUJiTXd3YXpGb3RCTzFkM0l4QlZOQ1hBQjhpMkJ2dyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQnRGQ0x2SnVKc2xyNm16UWZxMUxnMGJiR29adWl3OE9CUmFRRVRNWEdfelEiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUNBTkFQR2hZSVdtWVRaOVlHTDMxdEJOWmlvbTgybzl6OUVkS3RlX3NaN3h3In19"}],"service":[{"id":"#domain-1","type":"LinkedDomains","serviceEndpoint":{"nodes":["https://foo.example.com"]}}],"verificationMethod":[{"id":"#key-1","controller":"did:ion:test:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJpUkpfMGJQN0V6Q1NHRnBHYnYtaFlXZTdoZzItTkJhbDZxOU4tMUc3VWxJIiwieSI6IjZQZWV4VHF4V01WMy1Tc1pXT2tMbHkzN3V6Zm5iUUpFbUVMOEcyMnp5UVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlEU2NyamQ4eVNQM2NTRUJiTXd3YXpGb3RCTzFkM0l4QlZOQ1hBQjhpMkJ2dyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQnRGQ0x2SnVKc2xyNm16UWZxMUxnMGJiR29adWl3OE9CUmFRRVRNWEdfelEiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUNBTkFQR2hZSVdtWVRaOVlHTDMxdEJOWmlvbTgybzl6OUVkS3RlX3NaN3h3In19","type":"EcdsaSecp256k1VerificationKey2019","publicKeyJwk":{"crv":"secp256k1","kty":"EC","x":"iRJ_0bP7EzCSGFpGbv-hYWe7hg2-NBal6q9N-1G7UlI","y":"6PeexTqxWMV3-SsZWOkLly37uzfnbQJEmEL8G22zyQU"}}],"authentication":["#key-1"]},"didDocumentMetadata":{"method":{"published":false,"recoveryCommitment":"EiCANAPGhYIWmYTZ9YGL31tBNZiom82o9z9EdKte_sZ7xw","updateCommitment":"EiDScrjd8ySP3cSEBbMwwazFotBO1d3IxBVNCXAB8i2Bvw"},"equivalentId":["did:ion:EiAH4mOt_BJthhMkoizi9538NYHtP4-ai49hzQU9WSIJjA"]}}`

	didLongForm2  = "did:ion:test:EiDgkmlHYSuqydJ4nVYd5vX9vlT62Q5MVRLfdND9MG-7WA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJnelJlYktzWDV6VWhnbEtqY3UwOVpXMzZHeDFHenV5MF9rZ0tIelJnb3FBIiwieSI6IjZYbDJuWk5nQXQ4Y1RaLXhldUNjN2tSLXVuaHYxREszVTk0X2xrc2dacXcifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2dvb2dsZS5jb20iLCJ0eXBlIjoiTGlua2VkRG9tYWlucyJ9XX19XSwidXBkYXRlQ29tbWl0bWVudCI6IkVpQk83R2FOYnF2Szc4aG1UUm5XS2dQVUk5Y1g4UElqWlZvX1dzYmsxYkZDTUEifSwic3VmZml4RGF0YSI6eyJkZWx0YUhhc2giOiJFaUIwMXZkVGpISlgwX3laQVJXYmZYX0JWX2J3QkVOdHlYazRIblUzLU95VEdBIiwicmVjb3ZlcnlDb21taXRtZW50IjoiRWlBV2g3VXRGNUtlTDZUWnVoRlV6ajd6SlhpaEwxbnJSY2ZQRjR2emprSHpXUSJ9fQ"
	didDoc2InJSON = `{"@context":"https://w3id.org/did-resolution/v1","didDocument":{"id":"did:ion:test:EiDgkmlHYSuqydJ4nVYd5vX9vlT62Q5MVRLfdND9MG-7WA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJnelJlYktzWDV6VWhnbEtqY3UwOVpXMzZHeDFHenV5MF9rZ0tIelJnb3FBIiwieSI6IjZYbDJuWk5nQXQ4Y1RaLXhldUNjN2tSLXVuaHYxREszVTk0X2xrc2dacXcifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2dvb2dsZS5jb20iLCJ0eXBlIjoiTGlua2VkRG9tYWlucyJ9XX19XSwidXBkYXRlQ29tbWl0bWVudCI6IkVpQk83R2FOYnF2Szc4aG1UUm5XS2dQVUk5Y1g4UElqWlZvX1dzYmsxYkZDTUEifSwic3VmZml4RGF0YSI6eyJkZWx0YUhhc2giOiJFaUIwMXZkVGpISlgwX3laQVJXYmZYX0JWX2J3QkVOdHlYazRIblUzLU95VEdBIiwicmVjb3ZlcnlDb21taXRtZW50IjoiRWlBV2g3VXRGNUtlTDZUWnVoRlV6ajd6SlhpaEwxbnJSY2ZQRjR2emprSHpXUSJ9fQ","@context":["https://www.w3.org/ns/did/v1",{"@base":"did:ion:test:EiDgkmlHYSuqydJ4nVYd5vX9vlT62Q5MVRLfdND9MG-7WA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJnelJlYktzWDV6VWhnbEtqY3UwOVpXMzZHeDFHenV5MF9rZ0tIelJnb3FBIiwieSI6IjZYbDJuWk5nQXQ4Y1RaLXhldUNjN2tSLXVuaHYxREszVTk0X2xrc2dacXcifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2dvb2dsZS5jb20iLCJ0eXBlIjoiTGlua2VkRG9tYWlucyJ9XX19XSwidXBkYXRlQ29tbWl0bWVudCI6IkVpQk83R2FOYnF2Szc4aG1UUm5XS2dQVUk5Y1g4UElqWlZvX1dzYmsxYkZDTUEifSwic3VmZml4RGF0YSI6eyJkZWx0YUhhc2giOiJFaUIwMXZkVGpISlgwX3laQVJXYmZYX0JWX2J3QkVOdHlYazRIblUzLU95VEdBIiwicmVjb3ZlcnlDb21taXRtZW50IjoiRWlBV2g3VXRGNUtlTDZUWnVoRlV6ajd6SlhpaEwxbnJSY2ZQRjR2emprSHpXUSJ9fQ"}],"service":[{"id":"#domain-1","type":"LinkedDomains","serviceEndpoint":{"nodes":["https://google.com"]}}],"verificationMethod":[{"id":"#key-1","controller":"did:ion:test:EiDgkmlHYSuqydJ4nVYd5vX9vlT62Q5MVRLfdND9MG-7WA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJnelJlYktzWDV6VWhnbEtqY3UwOVpXMzZHeDFHenV5MF9rZ0tIelJnb3FBIiwieSI6IjZYbDJuWk5nQXQ4Y1RaLXhldUNjN2tSLXVuaHYxREszVTk0X2xrc2dacXcifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2dvb2dsZS5jb20iLCJ0eXBlIjoiTGlua2VkRG9tYWlucyJ9XX19XSwidXBkYXRlQ29tbWl0bWVudCI6IkVpQk83R2FOYnF2Szc4aG1UUm5XS2dQVUk5Y1g4UElqWlZvX1dzYmsxYkZDTUEifSwic3VmZml4RGF0YSI6eyJkZWx0YUhhc2giOiJFaUIwMXZkVGpISlgwX3laQVJXYmZYX0JWX2J3QkVOdHlYazRIblUzLU95VEdBIiwicmVjb3ZlcnlDb21taXRtZW50IjoiRWlBV2g3VXRGNUtlTDZUWnVoRlV6ajd6SlhpaEwxbnJSY2ZQRjR2emprSHpXUSJ9fQ","type":"EcdsaSecp256k1VerificationKey2019","publicKeyJwk":{"crv":"secp256k1","kty":"EC","x":"gzRebKsX5zUhglKjcu09ZW36Gx1Gzuy0_kgKHzRgoqA","y":"6Xl2nZNgAt8cTZ-xeuCc7kR-unhv1DK3U94_lksgZqw"}}],"authentication":["#key-1"]},"didDocumentMetadata":{"method":{"published":false,"recoveryCommitment":"EiAWh7UtF5KeL6TZuhFUzj7zJXihL1nrRcfPF4vzjkHzWQ","updateCommitment":"EiBO7GaNbqvK78hmTRnWKgPUI9cX8PIjZVo_Wsbk1bFCMA"},"equivalentId":["did:ion:EiDgkmlHYSuqydJ4nVYd5vX9vlT62Q5MVRLfdND9MG-7WA"]}}`

	didShortForm3 = "did:ion:test:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg"
	didLongForm3  = "did:ion:test:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJvYm1rencwOGdTdUZWdkZGbVJVUFcyRklDd3N3VWNyRHJhVUp1VEpIREswIiwieSI6IjNxLTNZWGJnMG9CbllDZGZGcFNBUGU3elNyX0VqOWFlcGh2c2VRTTc2N00ifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMENIUlZCemdSNkFkLVNHRlZwTU4wMU1RQmx4N0Mxd2pnblk4NmxELWJiUSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ0puMHlvLWZQYWk1dmltWmJYREUxWEctZURacVZzY2F1TkJsTXJtZWg3a1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUFkUXZTQUxzVG0zQmZZZU5nQWFndnZnTnU5bHlTNUFxcmFLRndWOFZLRDBBIn19"
	didDoc3InJSON = `{"@context":"https://w3id.org/did-resolution/v1","didDocument":{"id":"did:ion:test:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJvYm1rencwOGdTdUZWdkZGbVJVUFcyRklDd3N3VWNyRHJhVUp1VEpIREswIiwieSI6IjNxLTNZWGJnMG9CbllDZGZGcFNBUGU3elNyX0VqOWFlcGh2c2VRTTc2N00ifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMENIUlZCemdSNkFkLVNHRlZwTU4wMU1RQmx4N0Mxd2pnblk4NmxELWJiUSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ0puMHlvLWZQYWk1dmltWmJYREUxWEctZURacVZzY2F1TkJsTXJtZWg3a1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUFkUXZTQUxzVG0zQmZZZU5nQWFndnZnTnU5bHlTNUFxcmFLRndWOFZLRDBBIn19","@context":["https://www.w3.org/ns/did/v1",{"@base":"did:ion:test:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJvYm1rencwOGdTdUZWdkZGbVJVUFcyRklDd3N3VWNyRHJhVUp1VEpIREswIiwieSI6IjNxLTNZWGJnMG9CbllDZGZGcFNBUGU3elNyX0VqOWFlcGh2c2VRTTc2N00ifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMENIUlZCemdSNkFkLVNHRlZwTU4wMU1RQmx4N0Mxd2pnblk4NmxELWJiUSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ0puMHlvLWZQYWk1dmltWmJYREUxWEctZURacVZzY2F1TkJsTXJtZWg3a1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUFkUXZTQUxzVG0zQmZZZU5nQWFndnZnTnU5bHlTNUFxcmFLRndWOFZLRDBBIn19"}],"service":[{"id":"#domain-1","type":"LinkedDomains","serviceEndpoint":{"nodes":["https://foo.example.com"]}}],"verificationMethod":[{"id":"#key-1","controller":"did:ion:test:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJvYm1rencwOGdTdUZWdkZGbVJVUFcyRklDd3N3VWNyRHJhVUp1VEpIREswIiwieSI6IjNxLTNZWGJnMG9CbllDZGZGcFNBUGU3elNyX0VqOWFlcGh2c2VRTTc2N00ifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMENIUlZCemdSNkFkLVNHRlZwTU4wMU1RQmx4N0Mxd2pnblk4NmxELWJiUSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ0puMHlvLWZQYWk1dmltWmJYREUxWEctZURacVZzY2F1TkJsTXJtZWg3a1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUFkUXZTQUxzVG0zQmZZZU5nQWFndnZnTnU5bHlTNUFxcmFLRndWOFZLRDBBIn19","type":"EcdsaSecp256k1VerificationKey2019","publicKeyJwk":{"crv":"secp256k1","kty":"EC","x":"obmkzw08gSuFVvFFmRUPW2FICwswUcrDraUJuTJHDK0","y":"3q-3YXbg0oBnYCdfFpSAPe7zSr_Ej9aephvseQM767M"}}],"authentication":["#key-1"]},"didDocumentMetadata":{"method":{"published":false,"recoveryCommitment":"EiAdQvSALsTm3BfYeNgAagvvgNu9lyS5AqraKFwV8VKD0A","updateCommitment":"EiB0CHRVBzgR6Ad-SGFVpMN01MQBlx7C1wjgnY86lD-bbQ"},"equivalentId":["did:ion:EiD14UVh3WOeNoP5lD4bYsBO7TRoNaOaJsdumdtlj9H7Tg"]}}`

	didShortForm4 = "did:ion:test:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA"
	didLongForm4  = "did:ion:test:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJNTVplY0pqV05ZV2lJdi1KV2RjUUs2TGpTcURSdjg5MHU2a2dBVjBPMklRIiwieSI6Imh3OWthY2czNUxCVFpadnNZekE0Z2xWbE1MS2JFMkYxTzgwamJKMmFXZzAifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCbUJQa01ma0stYi1pdnpueGY3VkVmOUd1QWt4QlpkX3BkeTdic2d0RkNSQSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ2dieW05ZVJSalR2cm9RaGxLaXVHUlpRazA5aUNSUDhkcC1VaTNTdjcwNWciLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaURXcWNWbWU4MHBRMG45LVA4Vmt6alRQQ1NSNy0zSmZvWDZfVUcwZVAxRUVBIn19"
	didDoc4InJSON = `{"@context":"https://w3id.org/did-resolution/v1","didDocument":{"id":"did:ion:test:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJNTVplY0pqV05ZV2lJdi1KV2RjUUs2TGpTcURSdjg5MHU2a2dBVjBPMklRIiwieSI6Imh3OWthY2czNUxCVFpadnNZekE0Z2xWbE1MS2JFMkYxTzgwamJKMmFXZzAifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCbUJQa01ma0stYi1pdnpueGY3VkVmOUd1QWt4QlpkX3BkeTdic2d0RkNSQSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ2dieW05ZVJSalR2cm9RaGxLaXVHUlpRazA5aUNSUDhkcC1VaTNTdjcwNWciLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaURXcWNWbWU4MHBRMG45LVA4Vmt6alRQQ1NSNy0zSmZvWDZfVUcwZVAxRUVBIn19","@context":["https://www.w3.org/ns/did/v1",{"@base":"did:ion:test:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJNTVplY0pqV05ZV2lJdi1KV2RjUUs2TGpTcURSdjg5MHU2a2dBVjBPMklRIiwieSI6Imh3OWthY2czNUxCVFpadnNZekE0Z2xWbE1MS2JFMkYxTzgwamJKMmFXZzAifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCbUJQa01ma0stYi1pdnpueGY3VkVmOUd1QWt4QlpkX3BkeTdic2d0RkNSQSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ2dieW05ZVJSalR2cm9RaGxLaXVHUlpRazA5aUNSUDhkcC1VaTNTdjcwNWciLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaURXcWNWbWU4MHBRMG45LVA4Vmt6alRQQ1NSNy0zSmZvWDZfVUcwZVAxRUVBIn19"}],"service":[{"id":"#domain-1","type":"LinkedDomains","serviceEndpoint":{"nodes":["https://foo.example.com"]}}],"verificationMethod":[{"id":"#key-1","controller":"did:ion:test:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiJNTVplY0pqV05ZV2lJdi1KV2RjUUs2TGpTcURSdjg5MHU2a2dBVjBPMklRIiwieSI6Imh3OWthY2czNUxCVFpadnNZekE0Z2xWbE1MS2JFMkYxTzgwamJKMmFXZzAifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCbUJQa01ma0stYi1pdnpueGY3VkVmOUd1QWt4QlpkX3BkeTdic2d0RkNSQSJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQ2dieW05ZVJSalR2cm9RaGxLaXVHUlpRazA5aUNSUDhkcC1VaTNTdjcwNWciLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaURXcWNWbWU4MHBRMG45LVA4Vmt6alRQQ1NSNy0zSmZvWDZfVUcwZVAxRUVBIn19","type":"EcdsaSecp256k1VerificationKey2019","publicKeyJwk":{"crv":"secp256k1","kty":"EC","x":"MMZecJjWNYWiIv-JWdcQK6LjSqDRv890u6kgAV0O2IQ","y":"hw9kacg35LBTZZvsYzA4glVlMLKbE2F1O80jbJ2aWg0"}}],"authentication":["#key-1"]},"didDocumentMetadata":{"method":{"published":false,"recoveryCommitment":"EiDWqcVme80pQ0n9-P8VkzjTPCSR7-3JfoX6_UG0eP1EEA","updateCommitment":"EiBmBPkMfkK-b-ivznxf7VEf9GuAkxBZd_pdy7bsgtFCRA"},"equivalentId":["did:ion:EiDHDoQBtRfX1NMoXggBNDo-uI0Fu4nmt61ppBaTbGA6cA"]}}`

	didLongForm5  = "did:ion:test:EiBb5Gj6w1UtWbd_TNVgj8fBcW0vu2qVm7CVL_XB2drEmQ:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiI5bWw3Z0FYWm5QcU41U0lXaDh3a1RVbjJMSV9acldEWWk2bjJxTEJKWUZvIiwieSI6IndzZXhrb1FlUEdGRmt2N3NXcGZIZ3Y3emgta2ZfbktIWTNwYXA0Y01hLVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMElUZ0ZmU3JsaDg3THBtaHQyZ2FkUzZDOWdmdWhyeU1QUXF1anBDSzdTZyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQVRWNXRNVm1qVnlpREFtWjFZeGZNNnRyYUVZWUJQRVhqREZ1ekFyb3ZIc1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUR0MExkUHJrN3pldUJNR2ZZekpmR0xPbkt3ZU50d3VSeHV2Nl9ZaUVRWVZRIn19"
	didDoc5InJSON = `{"@context":"https://w3id.org/did-resolution/v1","didDocument":{"id":"did:ion:test:EiBb5Gj6w1UtWbd_TNVgj8fBcW0vu2qVm7CVL_XB2drEmQ:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiI5bWw3Z0FYWm5QcU41U0lXaDh3a1RVbjJMSV9acldEWWk2bjJxTEJKWUZvIiwieSI6IndzZXhrb1FlUEdGRmt2N3NXcGZIZ3Y3emgta2ZfbktIWTNwYXA0Y01hLVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMElUZ0ZmU3JsaDg3THBtaHQyZ2FkUzZDOWdmdWhyeU1QUXF1anBDSzdTZyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQVRWNXRNVm1qVnlpREFtWjFZeGZNNnRyYUVZWUJQRVhqREZ1ekFyb3ZIc1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUR0MExkUHJrN3pldUJNR2ZZekpmR0xPbkt3ZU50d3VSeHV2Nl9ZaUVRWVZRIn19","@context":["https://www.w3.org/ns/did/v1",{"@base":"did:ion:test:EiBb5Gj6w1UtWbd_TNVgj8fBcW0vu2qVm7CVL_XB2drEmQ:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiI5bWw3Z0FYWm5QcU41U0lXaDh3a1RVbjJMSV9acldEWWk2bjJxTEJKWUZvIiwieSI6IndzZXhrb1FlUEdGRmt2N3NXcGZIZ3Y3emgta2ZfbktIWTNwYXA0Y01hLVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMElUZ0ZmU3JsaDg3THBtaHQyZ2FkUzZDOWdmdWhyeU1QUXF1anBDSzdTZyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQVRWNXRNVm1qVnlpREFtWjFZeGZNNnRyYUVZWUJQRVhqREZ1ekFyb3ZIc1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUR0MExkUHJrN3pldUJNR2ZZekpmR0xPbkt3ZU50d3VSeHV2Nl9ZaUVRWVZRIn19"}],"service":[{"id":"#domain-1","type":"LinkedDomains","serviceEndpoint":{"nodes":["https://foo.example.com"]}}],"verificationMethod":[{"id":"#key-1","controller":"did:ion:test:EiBb5Gj6w1UtWbd_TNVgj8fBcW0vu2qVm7CVL_XB2drEmQ:eyJkZWx0YSI6eyJwYXRjaGVzIjpbeyJhY3Rpb24iOiJyZXBsYWNlIiwiZG9jdW1lbnQiOnsicHVibGljS2V5cyI6W3siaWQiOiJrZXktMSIsInB1YmxpY0tleUp3ayI6eyJjcnYiOiJzZWNwMjU2azEiLCJrdHkiOiJFQyIsIngiOiI5bWw3Z0FYWm5QcU41U0lXaDh3a1RVbjJMSV9acldEWWk2bjJxTEJKWUZvIiwieSI6IndzZXhrb1FlUEdGRmt2N3NXcGZIZ3Y3emgta2ZfbktIWTNwYXA0Y01hLVUifSwicHVycG9zZXMiOlsiYXV0aGVudGljYXRpb24iXSwidHlwZSI6IkVjZHNhU2VjcDI1NmsxVmVyaWZpY2F0aW9uS2V5MjAxOSJ9XSwic2VydmljZXMiOlt7ImlkIjoiZG9tYWluLTEiLCJzZXJ2aWNlRW5kcG9pbnQiOiJodHRwczovL2Zvby5leGFtcGxlLmNvbSIsInR5cGUiOiJMaW5rZWREb21haW5zIn1dfX1dLCJ1cGRhdGVDb21taXRtZW50IjoiRWlCMElUZ0ZmU3JsaDg3THBtaHQyZ2FkUzZDOWdmdWhyeU1QUXF1anBDSzdTZyJ9LCJzdWZmaXhEYXRhIjp7ImRlbHRhSGFzaCI6IkVpQVRWNXRNVm1qVnlpREFtWjFZeGZNNnRyYUVZWUJQRVhqREZ1ekFyb3ZIc1EiLCJyZWNvdmVyeUNvbW1pdG1lbnQiOiJFaUR0MExkUHJrN3pldUJNR2ZZekpmR0xPbkt3ZU50d3VSeHV2Nl9ZaUVRWVZRIn19","type":"EcdsaSecp256k1VerificationKey2019","publicKeyJwk":{"crv":"secp256k1","kty":"EC","x":"9ml7gAXZnPqN5SIWh8wkTUn2LI_ZrWDYi6n2qLBJYFo","y":"wsexkoQePGFFkv7sWpfHgv7zh-kf_nKHY3pap4cMa-U"}}],"authentication":["#key-1"]},"didDocumentMetadata":{"method":{"published":false,"recoveryCommitment":"EiDt0LdPrk7zeuBMGfYzJfGLOnKweNtwuRxuv6_YiEQYVQ","updateCommitment":"EiB0ITgFfSrlh87Lpmht2gadS6C9gfuhryMPQqujpCK7Sg"},"equivalentId":["did:ion:EiBb5Gj6w1UtWbd_TNVgj8fBcW0vu2qVm7CVL_XB2drEmQ"]}}`
)

func (m *MockInterface) ExpectRegisterDIDAny() *gomock.Call {
	return m.EXPECT().
		RegisterDID(gomock.Any()).
		Return("", nil).
		AnyTimes()
}

func (m *MockInterface) ExpectResolveDIDAny() {
	didDoc3 := new(DID)
	if err := json.Unmarshal([]byte(didDoc1InJSON), didDoc3); err != nil {
		panic(err)
	}
	didDoc5 := new(DID)
	if err := json.Unmarshal([]byte(didDoc2InJSON), didDoc5); err != nil {
		panic(err)
	}
	didDoc6 := new(DID)
	if err := json.Unmarshal([]byte(didDoc3InJSON), didDoc6); err != nil {
		panic(err)
	}
	didDoc7 := new(DID)
	if err := json.Unmarshal([]byte(didDoc4InJSON), didDoc7); err != nil {
		panic(err)
	}
	didDoc8 := new(DID)
	if err := json.Unmarshal([]byte(didDoc5InJSON), didDoc8); err != nil {
		panic(err)
	}

	m.EXPECT().
		ResolveDID(didShortForm1).
		Return(didDoc3, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didLongForm1).
		Return(didDoc3, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didLongForm2).
		Return(didDoc5, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didShortForm3).
		Return(didDoc6, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didLongForm3).
		Return(didDoc6, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didShortForm4).
		Return(didDoc7, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didLongForm4).
		Return(didDoc7, nil).
		AnyTimes()
	m.EXPECT().
		ResolveDID(didLongForm5).
		Return(didDoc8, nil).
		AnyTimes()
}
